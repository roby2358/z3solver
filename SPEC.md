# SMT Solver with LLM Translation Layer

## Overview

A browser-based application that uses an LLM to translate natural language problems into SMT-LIB format, solves them using an in-browser solver, and translates solutions back to human-readable form.

## Architecture

```
User Problem (NL) 
    → LLM Translation → SMT-LIB
    → LLM Back-Translation → Verification (NL)
    → User Confirms
    → Z3 WASM Solver → Raw Solution
    → LLM Translation → Human-Readable Solution
```

## Requirements

### Runtime Environment

1. The application MUST run entirely in the browser with no server-side computation.
2. The application MUST use WebAssembly-based Z3 (or equivalent SMT solver) for constraint solving.
3. The application MUST support round-trip communication with an LLM API for translation steps.

### User Interface

The interface MUST present the following elements in order:

#### 1. Problem Input
- MUST provide an editable text area for the user to describe their problem in natural language.
- SHOULD include placeholder text with an example problem.

#### 2. Translate Button
- MUST trigger LLM translation of the problem to SMT-LIB format.
- MUST be disabled while translation is in progress.
- SHOULD display a loading indicator during translation.

#### 3. Translated Problem (SMT-LIB)
- MUST display the SMT-LIB representation generated by the LLM.
- SHOULD be editable to allow manual corrections.
- SHOULD use monospace font and syntax highlighting if feasible.

#### 4. Back-Translation (Verification)
- MUST display a natural language description of what the SMT-LIB constraints actually represent.
- MUST be generated by a separate LLM call translating SMT-LIB back to natural language.
- This allows the user to verify the translation captured their intent.

#### 5. Confirm Button
- MUST trigger the solver to execute on the SMT-LIB input.
- MUST be disabled until both forward and back translations are complete.
- SHOULD be disabled if the SMT-LIB contains syntax errors (if detectable).

#### 6. Raw Solver Output
- MUST display the raw output from the SMT solver (sat/unsat + model or unsat core).
- SHOULD use monospace formatting.

#### 7. Solution Translation
- MUST display the solver output translated back to the original problem domain.
- MUST be generated by an LLM call that receives both the original problem and the solver output.
- SHOULD present the solution in a format that directly answers the user's original question.

### LLM Integration

1. The application MUST support configuration of the LLM API endpoint and credentials.
2. The application SHOULD store API configuration in browser local storage.
3. The application MUST make three distinct LLM calls per solve cycle:
   - Problem → SMT-LIB translation
   - SMT-LIB → Natural language back-translation (verification)
   - Raw solution → Human-readable solution translation
4. The application MUST include appropriate system prompts for each translation step.
5. The application SHOULD handle LLM API errors gracefully with user-visible error messages.

### Solver Integration

1. The application MUST load the SMT solver asynchronously to avoid blocking page load.
2. The application MUST handle solver timeout scenarios.
3. The application SHOULD allow configuration of solver timeout duration.
4. The application MUST handle all solver outcomes: sat, unsat, unknown, and errors.

### Error Handling

1. The application MUST display errors from the solver (syntax errors, timeout, etc.) in the raw output area.
2. The application SHOULD allow the user to edit the SMT-LIB and retry without re-translating from scratch.
3. The application MUST NOT proceed to solution translation if the solver returns unsat, unknown, or error.
4. When unsat, the application SHOULD use the LLM to explain why no solution exists.

## Non-Functional Requirements

1. The application SHOULD remain responsive during solver execution (web worker or async).
2. The application SHOULD preserve user input across page refreshes (local storage).
3. The application MUST work in modern browsers (Chrome, Firefox, Safari, Edge - latest 2 versions).

## Future Considerations (Out of Scope)

- Optimization problems (maximize/minimize)
- Incremental solving
- Multiple solution enumeration
- Problem templates/examples library
- Sharing/exporting problem definitions